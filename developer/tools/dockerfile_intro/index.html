<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.56.3" />
    <meta name="description" content="Learn, Practice and Make difference">
<meta name="author" content="Adenosine">

    <link rel="shortcut icon" href="/images/site_elements/star_logo.png" type="image/x-icon" />
<link rel="icon" href="/images/site_elements/star_logo.png" type="image/x-icon" />
    <title>Dockerfile_intro :: Documentation for Hugo Learn Theme</title>

    
    <link href="/css/nucleus.css?1565642678" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1565642678" rel="stylesheet">
    <link href="/css/hybrid.css?1565642678" rel="stylesheet">
    <link href="/css/featherlight.min.css?1565642678" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1565642678" rel="stylesheet">
    <link href="/css/auto-complete.css?1565642678" rel="stylesheet">
    <link href="/css/theme.css?1565642678" rel="stylesheet">
    <link href="/css/hugo-theme.css?1565642678" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1565642678" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1565642678"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/developer/tools/dockerfile_intro/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

  <img src="/images/site_elements/star_logo.png" alt="">
  
  </a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1565642678"></script>
<script type="text/javascript" src="/js/auto-complete.js?1565642678"></script>
<script type="text/javascript">
    
        var baseurl = "\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1565642678"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/me/" title="me" class="dd-item 
        
        
        
        ">
      <a href="/me/">
          Me, Myself and I
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/me/track_my_work/" title="Best Practice Logs" class="dd-item ">
        <a href="/me/track_my_work/">
        Best Practice Logs
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/me/skill_tree/" title="My Skill Tree and Experience" class="dd-item ">
        <a href="/me/skill_tree/">
        My Skill Tree and Experience
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/me/better_develpoer/" title="Better Develpoer" class="dd-item ">
        <a href="/me/better_develpoer/">
        Better Develpoer
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/me/collections/" title="Collections" class="dd-item ">
        <a href="/me/collections/">
        Collections
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/datascience/" title="Datascience" class="dd-item 
        
        
        
        ">
      <a href="/datascience/">
          Data Science
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/datascience/ml/" title="Ml" class="dd-item 
        
        
        
        ">
      <a href="/datascience/ml/">
          Ml
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/datascience/sqlalchemy/" title="Sqlalchemy" class="dd-item ">
        <a href="/datascience/sqlalchemy/">
        Sqlalchemy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/datascience/numpy_fancy_indexing_and_viewing/" title="Fancy indexing, view and copy" class="dd-item ">
        <a href="/datascience/numpy_fancy_indexing_and_viewing/">
        Fancy indexing and view in numpy
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/datascience/pytorch/" title="Pytorch Learning" class="dd-item 
        
        
        
        ">
      <a href="/datascience/pytorch/">
          Pytorch Learning
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/datascience/commands_for_data_scientist/" title="Command line tricks for data scientist" class="dd-item ">
        <a href="/datascience/commands_for_data_scientist/">
        Data Science CLI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/developer/" title="Cs" class="dd-item 
        parent
        
        
        ">
      <a href="/developer/">
          Computer Science
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/developer/windows/" title="Windows" class="dd-item 
        
        
        
        ">
      <a href="/developer/windows/">
          Windows
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/developer/windows/active_directory/" title="Active_directory" class="dd-item ">
        <a href="/developer/windows/active_directory/">
        Active_directory
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/developer/tools/" title="Tools" class="dd-item 
        parent
        
        
        ">
      <a href="/developer/tools/">
          Tools
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/vim_useful/" title="Vim Cheatsheet" class="dd-item ">
        <a href="/developer/tools/vim_useful/">
        Vim cheatsheet
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/ssh_useful/" title="SSH Bestpractice" class="dd-item ">
        <a href="/developer/tools/ssh_useful/">
        SSH Bestpractice
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/raspberry_pi_3_nas/" title="Raspberry Pi 3" class="dd-item ">
        <a href="/developer/tools/raspberry_pi_3_nas/">
        Raspberry Pi 3
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/common_commands_useful/" title="Most-used Linux CLI" class="dd-item ">
        <a href="/developer/tools/common_commands_useful/">
        Most-used Linux CLI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/cli_improved/" title="Better CLI tools" class="dd-item ">
        <a href="/developer/tools/cli_improved/">
        Better CLI tools
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/cli_best_practice/" title="Build CLI Best practice" class="dd-item ">
        <a href="/developer/tools/cli_best_practice/">
        Build CLI Best practice
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/10_basic_commands_for_linux_performance_detection/" title="Check Linux Performance CLI" class="dd-item ">
        <a href="/developer/tools/10_basic_commands_for_linux_performance_detection/">
        Check Linux Performance CLI
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/dockerfile_intro/" title="Dockerfile_intro" class="dd-item active">
        <a href="/developer/tools/dockerfile_intro/">
        Dockerfile_intro
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/docker_beginner/" title="Docker: From Zero to Hero" class="dd-item ">
        <a href="/developer/tools/docker_beginner/">
        Docker beginner tutorial
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/terraform_useful/" title="Terraform Best Practice" class="dd-item ">
        <a href="/developer/tools/terraform_useful/">
        Terraform Best Practice
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/setup_mysql/" title="Install MySQL server on CentOS" class="dd-item ">
        <a href="/developer/tools/setup_mysql/">
        Install MySQL server on CentOS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/git_useful/" title="Useful Git commands" class="dd-item ">
        <a href="/developer/tools/git_useful/">
        Useful Git commands
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/tools/docker_useful/" title="Useful commands for docker" class="dd-item ">
        <a href="/developer/tools/docker_useful/">
        Useful commands for docker
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/developer/algorithm/" title="Algorithm" class="dd-item 
        
        
        
        ">
      <a href="/developer/algorithm/">
          Algorithm
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/developer/webtech/" title="Webtech" class="dd-item 
        
        
        
        ">
      <a href="/developer/webtech/">
          Webtech
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/developer/webtech/restful/" title="RESTful" class="dd-item ">
        <a href="/developer/webtech/restful/">
        RESTful
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/developer/linux/" title="Linux" class="dd-item 
        
        
        
        ">
      <a href="/developer/linux/">
          Linux
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/developer/linux/time-explain/" title="Time Command Explaination" class="dd-item ">
        <a href="/developer/linux/time-explain/">
        Time Command Explaination
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/linux/shell_compatiability/" title="Shells" class="dd-item ">
        <a href="/developer/linux/shell_compatiability/">
        Shells
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/linux/linux-cheatsheet/" title="Bash Cheatsheet on macOS" class="dd-item ">
        <a href="/developer/linux/linux-cheatsheet/">
        Bash Cheatsheet on macOS
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/linux/shells/" title="Work with Different Shells" class="dd-item ">
        <a href="/developer/linux/shells/">
        Work with Different Shells
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/developer/linux/systemd_mount/" title="Mount a filesystem" class="dd-item ">
        <a href="/developer/linux/systemd_mount/">
        Mount a filesystem
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/collections/" title="Collections" class="dd-item 
        
        
        
        ">
      <a href="/collections/">
          Collections
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/collections/bestpractice/" title="Bestpractice" class="dd-item 
        
        
        
        ">
      <a href="/collections/bestpractice/">
          Bestpractice
          
            <i class="fas read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/collections/snippets/" title="Snippets" class="dd-item 
        
        
        
        ">
      <a href="/collections/snippets/">
          Snippets
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/collections/snippets/python_platform/" title="Python Platform module" class="dd-item ">
        <a href="/collections/snippets/python_platform/">
        Python Platform module
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/cloud/" title="Cloud" class="dd-item 
        
        
        
        ">
      <a href="/cloud/">
          Cloud
          
            <i class="fas read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/cloud/elasticsearch-query-intro/" title="Elasticsearch Query Intro" class="dd-item ">
        <a href="/cloud/elasticsearch-query-intro/">
        Elasticsearch Query Intro
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/cloud/elastic-stacks-setup/" title="Elastic Stacks Setup" class="dd-item ">
        <a href="/cloud/elastic-stacks-setup/">
        Elastic Stacks Setup
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/cloud/logstash-101/" title="Intro to logstash" class="dd-item ">
        <a href="/cloud/logstash-101/">
        Intro to logstash
        <i class="fas fa-check read-icon"></i>
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://github.com/adenosinew"><i class='fab fa-fw fa-github'></i> My Github repo</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://github.com/adenosinew"><i class='fab fa-linkedin'></i> LinkedIn</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <p><i class="fas fa-heart"></i> Stand Proud <i class="fas fa-heart"></i></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>adenosinew</a> > <a href='/developer/'>Cs</a> > <a href='/developer/tools/'>Tools</a> > Dockerfile_intro
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#01-关于dockerfile">01 关于Dockerfile</a></li>
<li><a href="#02-dockerfile常用指令">02 Dockerfile常用指令</a>
<ul>
<li><a href="#2-1-from">2.1 FROM</a></li>
<li><a href="#2-2-maintainer">2.2 MAINTAINER</a></li>
<li><a href="#2-3-run">2.3 RUN</a></li>
<li><a href="#2-4-cmd">2.4 CMD</a></li>
<li><a href="#2-5-expose">2.5 EXPOSE</a></li>
<li><a href="#2-6-env">2.6 ENV</a></li>
<li><a href="#2-7-add">2.7 ADD</a></li>
<li><a href="#2-8-copy">2.8 COPY</a></li>
<li><a href="#2-9-entrypoint">2.9 ENTRYPOINT</a></li>
<li><a href="#2-10-volume">2.10 VOLUME</a></li>
<li><a href="#2-11-user">2.11 USER</a></li>
<li><a href="#2-12-workdir">2.12 WORKDIR</a></li>
<li><a href="#2-13-healthcheck">2.13 HEALTHCHECK</a></li>
<li><a href="#2-14-arg">2.14 ARG</a></li>
</ul></li>
<li><a href="#03-综合dockerfile案例">03 综合Dockerfile案例</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Dockerfile_intro</h1>
          

        





<h2 id="01-关于dockerfile">01 关于Dockerfile</h2>

<p>在Docker中创建镜像最常用的方式，就是使用Dockerfile。Dockerfile是一个Docker镜像的描述文件，我们可以理解成火箭发射的A、B、C、D…的步骤。Dockerfile其内部包含了一条条的指令，每一条指令构建一层，因此每一条指令的内容，就是描述该层应当如何构建。</p>

<p>一个Dockerfile的示例如下所示：</p>

<pre><code class="language-dockerfile">#基于centos镜像
FROM centos

#维护人的信息
MAINTAINER The CentOS Project

#安装httpd软件包
RUN yum -y update
RUN yum -y install httpd

#开启80端口
EXPOSE 80

#复制网站首页文件至镜像中web站点下
ADD index.html /var/www/html/index.html

#复制该脚本至镜像中，并修改其权限
ADD run.sh /run.sh
RUN chmod 775 /run.sh

#当启动容器时执行的脚本文件
CMD [&quot;/run.sh&quot;]
</code></pre>

<p>由上可知，Dockerfile结构大致分为四个部分：</p>

<ol>
<li>基础镜像信息</li>
<li>维护者信息</li>
<li>镜像操作指令</li>
<li>容器启动时执行指令。</li>
</ol>

<p>Dockerfile每行支持一条指令，每条指令可带多个参数，支持使用以#号开头的注释。下面会对上面使用到的一些常用指令做一些介绍。</p>

<h2 id="02-dockerfile常用指令">02 Dockerfile常用指令</h2>

<h3 id="2-1-from">2.1 FROM</h3>

<p>指明构建的新镜像是来自于哪个基础镜像，例如：</p>

<p><code>FROM centos:6</code></p>

<h3 id="2-2-maintainer">2.2 MAINTAINER</h3>

<p>指明镜像维护着及其联系方式（一般是邮箱地址），例如：</p>

<p><code>MAINTAINER example example@gmail.com</code></p>

<h3 id="2-3-run">2.3 RUN</h3>

<p>构建镜像时运行的Shell命令，例如：</p>

<pre><code>RUN [&quot;yum&quot;, &quot;install&quot;, &quot;httpd&quot;]
RUN yum install httpd
</code></pre>

<p>又如，我们在使用微软官方ASP.NET Core Runtime镜像时往往会加上以下RUN命令，弥补无法在默认镜像下使用Drawing相关接口的缺憾：</p>

<pre><code>FROM microsoft/dotnet:2.2.1-aspnetcore-runtime
RUN apt-get update
RUN apt-get install -y libgdiplus
RUN apt-get install -y libc6-dev
RUN ln -s /usr/lib/libgdiplus.so /lib/x86_64-linux-gnu/libgdiplus.so
</code></pre>

<h3 id="2-4-cmd">2.4 CMD</h3>

<p>启动容器时执行的Shell命令，例如：</p>

<pre><code>CMD [&quot;-C&quot;, &quot;/start.sh&quot;]
CMD [&quot;/usr/sbin/sshd&quot;, &quot;-D&quot;]
CMD /usr/sbin/sshd -D
</code></pre>

<h3 id="2-5-expose">2.5 EXPOSE</h3>

<p>声明容器运行的服务端口，例如：
<code>EXPOSE 80 443</code></p>

<h3 id="2-6-env">2.6 ENV</h3>

<p>设置环境内环境变量，例如：</p>

<pre><code>ENV MYSQL_ROOT_PASSWORD 123456
ENV JAVA_HOME /usr/local/jdk1.8.0_45
</code></pre>

<h3 id="2-7-add">2.7 ADD</h3>

<p>拷贝文件或目录到镜像中，例如：</p>

<pre><code>ADD &lt;src&gt;...&lt;dest&gt;
ADD html.tar.gz /var/www/html
ADD https://xxx.com/html.tar.gz /var/www/html
</code></pre>

<p>　　PS：如果是URL或压缩包，会自动下载或自动解压。</p>

<h3 id="2-8-copy">2.8 COPY</h3>

<p>拷贝文件或目录到镜像中，用法同ADD，只是不支持自动下载和解压，例如：</p>

<pre><code>COPY ./start.sh /start.sh
</code></pre>

<h3 id="2-9-entrypoint">2.9 ENTRYPOINT</h3>

<p>启动容器时执行的Shell命令，同CMD类似，只是由ENTRYPOINT启动的程序不会被docker run命令行指定的参数所覆盖，而且，这些命令行参数会被当作参数传递给ENTRYPOINT指定指定的程序，例如：</p>

<pre><code>ENTRYPOINT [&quot;/bin/bash&quot;, &quot;-C&quot;, &quot;/start.sh&quot;]
ENTRYPOINT /bin/bash -C '/start.sh'
</code></pre>

<p>　　PS：Dockerfile文件中也可以存在多个ENTRYPOINT指令，但仅有最后一个会生效。</p>

<h3 id="2-10-volume">2.10 VOLUME</h3>

<p>指定容器挂载点到宿主机自动生成的目录或其他容器，例如：</p>

<pre><code>VOLUME [&quot;/var/lib/mysql&quot;]
</code></pre>

<p>PS：一般不会在Dockerfile中用到，更常见的还是在docker run的时候指定-v数据卷。</p>

<h3 id="2-11-user">2.11 USER</h3>

<p>为RUN、CMD和ENTRYPOINT执行Shell命令指定运行用户，例如：</p>

<pre><code>USER &lt;user&gt;[:&lt;usergroup&gt;]
USER &lt;UID&gt;[:&lt;UID&gt;]
USER example
</code></pre>

<h3 id="2-12-workdir">2.12 WORKDIR</h3>

<p>为RUN、CMD、ENTRYPOINT以及COPY和AND设置工作目录，例如：</p>

<pre><code>WORKDIR /data
</code></pre>

<h3 id="2-13-healthcheck">2.13 HEALTHCHECK</h3>

<p>告诉Docker如何测试容器以检查它是否仍在工作，即健康检查，例如：</p>

<pre><code>HEALTHCHECK --interval=5m --timeout=3s --retries=3 \
    CMD curl -f http:/localhost/ || exit 1
</code></pre>

<p>　　其中，一些选项的说明：</p>

<p>&ndash;interval=DURATION (default: 30s)：每隔多长时间探测一次，默认30秒</p>

<p>&ndash; timeout= DURATION (default: 30s)：服务响应超时时长，默认30秒</p>

<p>&ndash;start-period= DURATION (default: 0s)：服务启动多久后开始探测，默认0秒</p>

<p>&ndash;retries=N (default: 3)：认为检测失败几次为宕机，默认3次</p>

<p>　　一些返回值的说明：</p>

<p>0：容器成功是健康的，随时可以使用</p>

<p>1：不健康的容器无法正常工作</p>

<p>2：保留不使用此退出代码</p>

<h3 id="2-14-arg">2.14 ARG</h3>

<p>在构建镜像时，指定一些参数，例如：</p>

<pre><code>FROM centos:6
ARG user # ARG user=root
USER $user
</code></pre>

<p>　　这时，我们在docker build时可以带上自定义参数user了，如下所示：</p>

<p>docker build &ndash;build-arg user=example Dockerfile .</p>

<h2 id="03-综合dockerfile案例">03 综合Dockerfile案例</h2>

<p>下面是一个Java Web应用的镜像Dockerfile，综合使用到了上述介绍中最常用的几个命令：</p>

<pre><code>FROM centos:7
MAINTANIER www.edisonchou.com

ADD jdk-8u45-linux-x64.tar.gz /usr/local
ENV JAVA_HOME /usr/local/jdk1.8.0_45

ADD apache-tomcat-8.0.46.tar.gz /usr/local
COPY server.xml /usr/local/apache-tomcat-8.0.46/conf

RUN rm -f /usr/local/*.tar.gz

WORKDIR /usr/local/apache-tomcat-8.0.46
EXPOSE 8080
ENTRYPOINT [&quot;./bin/catalina.sh&quot;, &quot;run&quot;]
　　有了Dockerfile，就可以创建镜像了：

docker build -t edc-tomcat:v1 .
　　最后，可以通过以下命令创建容器：

docker run -itd --name=tomcate -p 8080:8080 \
    -v /app/webapps/:/usr/local/apache-tomcat-8.0.46/webapps/ \
    edc-tomcat:v1
</code></pre>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/developer/tools/10_basic_commands_for_linux_performance_detection/" title="Check Linux Performance CLI"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/developer/tools/docker_beginner/" title="Docker: From Zero to Hero" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1565642679"></script>
    <script src="/js/perfect-scrollbar.min.js?1565642679"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1565642679"></script>
    <script src="/js/jquery.sticky.js?1565642679"></script>
    <script src="/js/featherlight.min.js?1565642679"></script>
    <script src="/js/html5shiv-printshiv.min.js?1565642679"></script>
    <script src="/js/highlight.pack.js?1565642679"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1565642679"></script>
    <script src="/js/learn.js?1565642679"></script>
    <script src="/js/hugo-learn.js?1565642679"></script>

    <link href="/mermaid/mermaid.css?1565642679" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1565642679"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

